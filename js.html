<script>

    function crearTablaContactos()
    {
        let tabla = document.getElementById('tablaContactos');
        if(tabla) tabla.remove();

        google.script.run
        .withSuccessHandler(crearTablaContactosCorrectamente)
        .withFailureHandler(crearTablaContactosError)
        .obtenerContactos();
    }


function crearTablaContactosCorrectamente(obj)
            {
                tabla = document.createElement('table');
                tabla.id = 'tablaContactos';

                let tablaHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');

                for(let i = 0; i < obj.length; i++)
                {
                    let fila = document.createElement('tr');
                    for(let j = 0; j < obj[i].length; j++)
                    {
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    if(i == 0)
                    {
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }
                    else
                    {
                        tablaBody.appendChild(fila);
                    }
                }


             
                //agregamos clases a la cabecera
                tablaHeader.classList.add('table-dark')
                //agregamos el cuerpo a la tabla
                tabla.appendChild(tablaBody);
                //agregamos clases a la tabla
                tabla.classList.add('table', 'table-striped', 'border', 'border-3');
                //agregamos tabla a la pagina
                document.getElementById('divContactos').appendChild(tabla);
                
                
                //mostrar notificacion de ok
                crearNotificacion(1,'contactos obtenidos correctamente','todo en orden')

            }

function crearTablaContactosError()
{
    //mostrar notificaion de error
}
 function crearNotificacion(tipo,mensaje,titulo)
 {
    //obtenemos datos
    let textoNotificacion=document.getElementById('mensajenotificacion');
    let tituloNotificacion=document.getElementById('tituloNotificacion');
    let elememtNotificacion=document.getElementById('notificacion');
    let iconoNotificacion=document.getElementById('iconoNotificacion');
    let notificacion=bootstrap.Toast.getOrCreateInstance(elememtoNotificacion);

    //editar la notificacion
    iconoNotificacion.className='';
    iconoNotificacion.classList.add('bi','bi-check2-square');
    mensajeNotificacion.textContent=mensaje;
    tituloNotificacion.textContent=titulo;
    elememtoNotificacion.style.backgroundColor=getComputedStyle(document.documentElement)
    .getPropertyValue('--color-verde-oscuro');

    //mostrar notificacion
    notificacion.show();

 }

</script>